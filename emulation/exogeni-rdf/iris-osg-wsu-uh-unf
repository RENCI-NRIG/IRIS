<rdf:RDF
    xmlns:ec2="http://geni-orca.renci.org/owl/ec2.owl#"
    xmlns:kansei="http://geni-orca.renci.org/owl/kansei.owl#"
    xmlns:app-color="http://geni-orca.renci.org/owl/app-color.owl#"
    xmlns:geni="http://geni-orca.renci.org/owl/geni.owl#"
    xmlns:domain="http://geni-orca.renci.org/owl/domain.owl#"
    xmlns:eucalyptus="http://geni-orca.renci.org/owl/eucalyptus.owl#"
    xmlns:j.0="http://geni-orca.renci.org/owl/storage.owl#"
    xmlns:collections="http://geni-orca.renci.org/owl/collections.owl#"
    xmlns:openflow="http://geni-orca.renci.org/owl/openflow.owl#"
    xmlns:request="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#"
    xmlns:xsd="http://www.w3.org/2001/XMLSchema#"
    xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
    xmlns:exogeni="http://geni-orca.renci.org/owl/exogeni.owl#"
    xmlns:layer="http://geni-orca.renci.org/owl/layer.owl#"
    xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#"
    xmlns:request-schema="http://geni-orca.renci.org/owl/request.owl#"
    xmlns:ip4="http://geni-orca.renci.org/owl/ip4.owl#"
    xmlns:planetlab="http://geni-orca.renci.org/owl/planetlab.owl#"
    xmlns:ethernet="http://geni-orca.renci.org/owl/ethernet.owl#"
    xmlns:dtn="http://geni-orca.renci.org/owl/dtn.owl#"
    xmlns:time="http://www.w3.org/2006/time#"
    xmlns:owl="http://www.w3.org/2002/07/owl#"
    xmlns:modify-schema="http://geni-orca.renci.org/owl/modify.owl#"
    xmlns:compute="http://geni-orca.renci.org/owl/compute.owl#"
    xmlns:topology="http://geni-orca.renci.org/owl/topology.owl#"
    xmlns:orca="http://geni-orca.renci.org/owl/orca.rdf#" > 
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link28-HoustonRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link28-HoustonRouter-ip-10-100-28-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link21-CacheUC">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link21-CacheUC-ip-192-168-21-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link12-ChicEQCHRouter-ip-10-100-12-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.12.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link13-TucsonRouter-ip-10-100-13-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.13.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link4-CacheNYU">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link4-CacheNYU-ip-192-168-4-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link88-PittRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link88-PittRouter-ip-10-100-88-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link87-PittRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link87-PittRouter-ip-10-100-87-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#CacheSeattle">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link24-CacheSeattle"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#SeattleRouter"/>
    <topology:hasGUID>0dbbd149-a561-4e05-8a97-5b36265254f1</topology:hasGUID>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash
  
sleep 5
#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )
echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#set ( $link = $linkset[0] )
echo $link &gt; /root/tmp
#set ( $gw = $SeattleRouter.IP($link) )
echo $gw &gt; /root/tmp

while ! ping -c 1 -n -w 1 $gw &amp;&gt; /dev/null
do
    echo "ping gw...." &gt;&gt; /root/tmp
    sleep 2
done
echo "\n%s\n"  "Server is back online" &gt;&gt; /root/tmp

ip route add 10.100.0.0/16 via $gw dev ens6
ip route add 172.16.0.0/16 via $gw dev ens6
ip route add 192.168.0.0/16 via $gw dev ens6

#set ( $hostname = $self.Name() )
echo $hostname:$gw &gt; /root/tmp_gw
#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp</request-schema:postBootScript>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/wsuvmsite.rdf#wsuvmsite/Domain"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOMedium"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link10-SaltLakeRouter-ip-10-100-10-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.10.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link57-IndianapolisRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link57-IndianapolisRouter-ip-10-100-57-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link61-ChicEQCHRouter-ip-10-100-61-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.61.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link0-SeattleRouter-ip-10-100-0-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.0.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link31-SunnyvaleRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link31-SunnyvaleRouter-ip-10-100-31-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link78-WashingtonRouter-ip-10-100-78-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.78.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link17-OriginFNAL">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link17-OriginFNAL-ip-192-168-17-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link76-CharlotteRouter-ip-10-100-76-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.76.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link62-UChicagoRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link62-UChicagoRouter-ip-10-100-62-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#OriginSDSC">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link20-OriginSDSC"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#SDRouter"/>
    <topology:hasGUID>f4f228a0-a9b8-44e7-9890-2b8b50da65f9</topology:hasGUID>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash
  
#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )
echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#set ( $link = $linkset[0] )
echo $link &gt; /root/tmp
#set ( $gw = $SDRouter.IP($link) )
echo $gw &gt; /root/tmp

while ! ping -c 1 -n -w 1 $gw &amp;&gt; /dev/null
do
    echo "ping gw...." &gt;&gt; /root/tmp
    sleep 2
done
echo "\n%s\n"  "Server is back online" &gt;&gt; /root/tmp

ip route add 10.100.0.0/16 via $gw dev ens6
ip route add 172.16.0.0/16 via $gw dev ens6
ip route add 192.168.0.0/16 via $gw dev ens6

#set ( $hostname = $self.Name() )
echo $hostname:$gw &gt; /root/tmp_gw
#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp

</request-schema:postBootScript>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/wsuvmsite.rdf#wsuvmsite/Domain"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOMedium"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link5-MinneapolisRouter-ip-10-100-5-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.5.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link52-BatonRougeRouter-ip-10-100-52-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.52.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link76-CharlotteRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link76-CharlotteRouter-ip-10-100-76-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link3-CacheSyracuse-ip-192-168-3-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.3.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link63-ChicEQCHRouter-ip-10-100-63-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.63.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#AshburnRouter">
    <topology:hasGUID>c517811b-ef37-49ca-9816-8623795018bf</topology:hasGUID>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link88-AshburnRouter"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link89-AshburnRouter"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/unfvmsite.rdf#unfvmsite/Domain"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#WashingtonRouter"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 8
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 8
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp</request-schema:postBootScript>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link62-FNALRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link62-FNALRouter-ip-10-100-62-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#CacheUNL">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link18-CacheUNL"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#KansasCityRouter"/>
    <topology:hasGUID>b1444c97-6016-4e20-8b30-384904476490</topology:hasGUID>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash
  
#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )
echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#set ( $link = $linkset[0] )
echo $link &gt; /root/tmp
#set ( $gw = $KansasCityRouter.IP($link) )
echo $gw &gt; /root/tmp

while ! ping -c 1 -n -w 1 $gw &amp;&gt; /dev/null
do
    echo "ping gw...." &gt;&gt; /root/tmp
    sleep 2
done
echo "\n%s\n"  "Server is back online" &gt;&gt; /root/tmp

ip route add 10.100.0.0/16 via $gw dev ens6
ip route add 172.16.0.0/16 via $gw dev ens6
ip route add 192.168.0.0/16 via $gw dev ens6

#set ( $hostname = $self.Name() )
echo $hostname:$gw &gt; /root/tmp_gw
#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp</request-schema:postBootScript>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/uhvmsite.rdf#uhvmsite/Domain"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOMedium"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link55-LouisvilleRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link55-LouisvilleRouter-ip-10-100-55-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link63-FNALRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link63-FNALRouter-ip-10-100-63-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#AlbanyRouter">
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link3-AlbanyRouter"/>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/unfvmsite.rdf#unfvmsite/Domain"/>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 8
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 8
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp</request-schema:postBootScript>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Cleveland"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link84-AlbanyRouter"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link85-AlbanyRouter"/>
    <topology:hasGUID>485443cd-4ccb-4ff3-a968-1b5538ef7b1e</topology:hasGUID>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link27-HoustonRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link27-HoustonRouter-ip-10-100-27-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link12-KansasCityRouter-ip-10-100-12-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.12.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link83-HartfordRouter-ip-10-100-83-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.83.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link11-SeattleRouter-ip-192-168-11-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.11.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#BostonRouter">
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 8
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 8
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp</request-schema:postBootScript>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link84-BostonRouter"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#HartfordRouter"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <topology:hasGUID>4779af6e-7a0c-4800-9e7d-43289a7bbd62</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/unfvmsite.rdf#unfvmsite/Domain"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link83-BostonRouter"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link27-HoustonRouter-ip-10-100-27-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.27.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link68-JacksonvilleRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link68-JacksonvilleRouter-ip-10-100-68-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link12-ChicEQCHRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link12-ChicEQCHRouter-ip-10-100-12-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/uhvmsite.rdf#uhvmsite/Domain">
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkDomain"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link77-WashingtonRouter-ip-10-100-77-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.77.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link27-ELPasoRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link27-ELPasoRouter-ip-10-100-27-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link30-EugeneRouter-ip-10-100-30-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.30.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link23-CacheCal-ip-192-168-23-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.23.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link49-DallasRouter-ip-10-100-49-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.49.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link40-SDRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link40-SDRouter-ip-10-100-40-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link0-MissoulaRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link0-MissoulaRouter-ip-10-100-0-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link50-DallasRouter-ip-10-100-50-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.50.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link8-PortlandRouter-ip-10-100-8-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.8.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link40-TucsonRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link40-TucsonRouter-ip-10-100-40-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#ELPasoRouter">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link2-ELPasoRouter"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link13-ELPasoRouter"/>
    <topology:hasGUID>db50f928-5e59-4bb0-bf70-a82f85c4a4c6</topology:hasGUID>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#TucsonRouter"/>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/uhvmsite.rdf#uhvmsite/Domain"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link27-ELPasoRouter"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 4
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 2
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp</request-schema:postBootScript>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link19-KansasCityRouter-ip-192-168-19-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.19.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link34-LasVegasRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link34-LasVegasRouter-ip-10-100-34-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#SaltLakeRouter">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link7-SaltLakeRouter"/>
    <topology:hasGUID>4cf9a77e-76eb-4e04-84ba-878acaabb046</topology:hasGUID>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 4
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 2
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp

</request-schema:postBootScript>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link10-SaltLakeRouter"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link34-SaltLakeRouter"/>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/wsuvmsite.rdf#wsuvmsite/Domain"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link36-SaltLakeRouter"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#SeattleRouter">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link8-SeattleRouter"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 4
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 2
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp

</request-schema:postBootScript>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link24-SeattleRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link0-SeattleRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link11-SeattleRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link10-SeattleRouter"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/wsuvmsite.rdf#wsuvmsite/Domain"/>
    <topology:hasGUID>d903497f-e9d6-40d7-8106-80780993cdf5</topology:hasGUID>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link2-DenverRouter-ip-10-100-2-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.2.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link30-EugeneRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link30-EugeneRouter-ip-10-100-30-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link36-RenoRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link36-RenoRouter-ip-10-100-36-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link51-JacksonRouter-ip-10-100-51-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.51.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#OriginFNAL">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link17-OriginFNAL"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#FNALRouter"/>
    <topology:hasGUID>7efa4cb3-f641-44d0-82c3-7b4681446b27</topology:hasGUID>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash
  
#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )
echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#set ( $link = $linkset[0] )
echo $link &gt; /root/tmp
#set ( $gw = $FNALRouter.IP($link) )
echo $gw &gt; /root/tmp

while ! ping -c 1 -n -w 1 $gw &amp;&gt; /dev/null
do
    echo "ping gw...." &gt;&gt; /root/tmp
    sleep 2
done
echo "\n%s\n"  "Server is back online" &gt;&gt; /root/tmp

ip route add 10.100.0.0/16 via $gw dev ens6
ip route add 172.16.0.0/16 via $gw dev ens6
ip route add 192.168.0.0/16 via $gw dev ens6

#set ( $hostname = $self.Name() )
echo $hostname:$gw &gt; /root/tmp_gw
#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp

</request-schema:postBootScript>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/uhvmsite.rdf#uhvmsite/Domain"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOMedium"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link29-EugeneRouter-ip-10-100-29-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.29.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link33-LasVegasRouter-ip-10-100-33-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.33.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link20-OriginSDSC">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link20-OriginSDSC-ip-192-168-20-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Cleveland">
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 8
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 8
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp</request-schema:postBootScript>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <topology:hasGUID>3e677e22-07bc-4593-a0e3-dee8693e4b0e</topology:hasGUID>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link86-Cleveland"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link87-Cleveland"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link85-Cleveland"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/unfvmsite.rdf#unfvmsite/Domain"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#PittRouter"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link14-CacheUChic-ip-192-168-14-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.14.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#CacheFNAL">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link16-CacheFNAL"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#FNALRouter"/>
    <topology:hasGUID>8f562208-6182-4ba7-a610-1e7cb49be647</topology:hasGUID>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash
  
#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )
echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#set ( $link = $linkset[0] )
echo $link &gt; /root/tmp
#set ( $gw = $FNALRouter.IP($link) )
echo $gw &gt; /root/tmp

while ! ping -c 1 -n -w 1 $gw &amp;&gt; /dev/null
do
    echo "ping gw...." &gt;&gt; /root/tmp
    sleep 2
done
echo "\n%s\n"  "Server is back online" &gt;&gt; /root/tmp

ip route add 10.100.0.0/16 via $gw dev ens6
ip route add 172.16.0.0/16 via $gw dev ens6
ip route add 192.168.0.0/16 via $gw dev ens6

#set ( $hostname = $self.Name() )
echo $hostname:$gw &gt; /root/tmp_gw
#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp

</request-schema:postBootScript>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/uhvmsite.rdf#uhvmsite/Domain"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOMedium"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link87-Cleveland-ip-10-100-87-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.87.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#CacheUC">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link21-CacheUC"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#SDRouter"/>
    <topology:hasGUID>ec849adf-daf8-45fa-9e7b-58a3cab685e5</topology:hasGUID>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash
  
#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )
echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#set ( $link = $linkset[0] )
echo $link &gt; /root/tmp
#set ( $gw = $SDRouter.IP($link) )
echo $gw &gt; /root/tmp

while ! ping -c 1 -n -w 1 $gw &amp;&gt; /dev/null
do
    echo "ping gw...." &gt;&gt; /root/tmp
    sleep 2
done
echo "\n%s\n"  "Server is back online" &gt;&gt; /root/tmp

ip route add 10.100.0.0/16 via $gw dev ens6
ip route add 172.16.0.0/16 via $gw dev ens6
ip route add 192.168.0.0/16 via $gw dev ens6

#set ( $hostname = $self.Name() )
echo $hostname:$gw &gt; /root/tmp_gw
#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp</request-schema:postBootScript>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/wsuvmsite.rdf#wsuvmsite/Domain"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOMedium"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link64-MinneapolisRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link64-MinneapolisRouter-ip-10-100-64-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#LasVegasRouter">
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 4
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 2
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp</request-schema:postBootScript>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#SaltLakeRouter"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/wsuvmsite.rdf#wsuvmsite/Domain"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link33-LasVegasRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link34-LasVegasRouter"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <topology:hasGUID>889a7df3-d246-49de-a816-db1d2826b794</topology:hasGUID>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link2-ELPasoRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link2-ELPasoRouter-ip-10-100-2-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link80-NewYorkRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link80-NewYorkRouter-ip-10-100-80-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link36-RenoRouter-ip-10-100-36-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.36.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link79-PhillyRouter-ip-10-100-79-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.79.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link55-JacksonRouter-ip-10-100-55-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.55.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link1-DenverRouter-ip-10-100-1-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.1.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link54-JacksonvilleRouter-ip-10-100-54-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.54.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link13-ELPasoRouter-ip-10-100-13-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.13.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link51-JacksonRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link51-JacksonRouter-ip-10-100-51-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#CacheCal">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link23-CacheCal"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#LARouter"/>
    <topology:hasGUID>1f5055c3-ec11-4959-90f0-b5ade757a740</topology:hasGUID>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash
  
sleep 5
#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )
echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#set ( $link = $linkset[0] )
echo $link &gt; /root/tmp
#set ( $gw = $LARouter.IP($link) )
echo $gw &gt; /root/tmp

while ! ping -c 1 -n -w 1 $gw &amp;&gt; /dev/null
do
    echo "ping gw...." &gt;&gt; /root/tmp
    sleep 2
done
echo "\n%s\n"  "Server is back online" &gt;&gt; /root/tmp

ip route add 10.100.0.0/16 via $gw dev ens6
ip route add 172.16.0.0/16 via $gw dev ens6
ip route add 192.168.0.0/16 via $gw dev ens6

#set ( $hostname = $self.Name() )
echo $hostname:$gw &gt; /root/tmp_gw
#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp</request-schema:postBootScript>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/wsuvmsite.rdf#wsuvmsite/Domain"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOMedium"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link54-JacksonvilleRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link54-JacksonvilleRouter-ip-10-100-54-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link58-IndianapolisRouter-ip-10-100-58-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.58.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link77-RaleighRouter-ip-10-100-77-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.77.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link28-BatonRougeRouter-ip-10-100-28-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.28.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link49-DallasRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link49-DallasRouter-ip-10-100-49-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link81">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link81-NewYorkRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link81-NYCRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>d348fbd3-bc5d-478b-b6bc-12475c13b73b</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link50-HoustonRouter-ip-10-100-50-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.50.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#CacheSyracuse">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link3-CacheSyracuse"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#AlbanyRouter"/>
    <topology:hasGUID>7dcd580d-3400-4b95-befc-d8c7b3bf928c</topology:hasGUID>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash
  
#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )
echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#set ( $link = $linkset[0] )
echo $link &gt; /root/tmp
#set ( $gw = $AlbanyRouter.IP($link) )
echo $gw &gt; /root/tmp

while ! ping -c 1 -n -w 1 $gw &amp;&gt; /dev/null
do
    echo "ping gw...." &gt;&gt; /root/tmp
    sleep 2
done
echo "\n%s\n"  "Server is back online" &gt;&gt; /root/tmp

ip route add 10.100.0.0/16 via $gw dev ens6
ip route add 172.16.0.0/16 via $gw dev ens6
ip route add 192.168.0.0/16 via $gw dev ens6

#set ( $hostname = $self.Name() )
echo $hostname:$gw &gt; /root/tmp_gw
#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp

</request-schema:postBootScript>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/unfvmsite.rdf#unfvmsite/Domain"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Term">
    <time:hasDurationDescription rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#TermDuration"/>
    <rdf:type rdf:resource="http://www.w3.org/2006/time#Interval"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#OriginSeattle">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link11-OriginSeattle"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#SeattleRouter"/>
    <topology:hasGUID>b7beb18b-d761-45ab-afb9-2e8e9dd47e71</topology:hasGUID>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash
  
#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )
echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#set ( $link = $linkset[0] )
echo $link &gt; /root/tmp
#set ( $gw = $SeattleRouter.IP($link) )
echo $gw &gt; /root/tmp

while ! ping -c 1 -n -w 1 $gw &amp;&gt; /dev/null
do
    echo "ping gw...." &gt;&gt; /root/tmp
    sleep 2
done
echo "\n%s\n"  "Server is back online" &gt;&gt; /root/tmp

ip route add 10.100.0.0/16 via $gw dev ens6
ip route add 172.16.0.0/16 via $gw dev ens6
ip route add 192.168.0.0/16 via $gw dev ens6

#set ( $hostname = $self.Name() )
echo $hostname:$gw &gt; /root/tmp_gw
#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp

</request-schema:postBootScript>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/wsuvmsite.rdf#wsuvmsite/Domain"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOMedium"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link21-SDRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link21-SDRouter-ip-192-168-21-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link37-RenoRouter-ip-10-100-37-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.37.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link16-CacheFNAL-ip-192-168-16-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.16.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link11-SeattleRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link11-SeattleRouter-ip-192-168-11-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link6-HartfordRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link6-HartfordRouter-ip-192-168-6-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link14-UChicagoRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link14-UChicagoRouter-ip-192-168-14-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link80">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link80-NewYorkRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link80-NYCRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>961c8f2b-7b0c-4b71-8393-2112c07d1c25</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link81-NYCRouter-ip-10-100-81-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.81.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link1-DenverRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link1-DenverRouter-ip-10-100-1-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link58-IndianapolisRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link58-IndianapolisRouter-ip-10-100-58-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link80-NewYorkRouter-ip-10-100-80-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.80.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link55-JacksonRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link55-JacksonRouter-ip-10-100-55-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link10-SeattleRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link10-SeattleRouter-ip-10-100-10-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link18-KansasCityRouter-ip-192-168-18-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.18.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link80-NYCRouter-ip-10-100-80-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.80.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link21-CacheUC-ip-192-168-21-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.21.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link83-HartfordRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link83-HartfordRouter-ip-10-100-83-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link64-UChicagoRouter-ip-10-100-64-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.64.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link6-HartfordRouter-ip-192-168-6-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.6.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#HoustonRouter">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link27-HoustonRouter"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#ELPasoRouter"/>
    <topology:hasGUID>a65a4433-9d65-4147-8cfc-8cd7ce416a01</topology:hasGUID>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/uhvmsite.rdf#uhvmsite/Domain"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link50-HoustonRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link51-HoustonRouter"/>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 4
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 2
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp</request-schema:postBootScript>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link28-HoustonRouter"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link83">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link83-BostonRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link83-HartfordRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>3afc42c3-26d4-400c-9c51-5964a2fd13f7</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link71">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link71-AtlantaRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link71-JacksonRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>1fc3d9f1-b0e0-47ed-b1c9-42abde1e7ce6</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link78-PhillyRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link78-PhillyRouter-ip-10-100-78-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link20-OriginSDSC-ip-192-168-20-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.20.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link52-PensacolaRouter-ip-10-100-52-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.52.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link89-AshburnRouter-ip-10-100-89-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.89.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link34-SaltLakeRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link34-SaltLakeRouter-ip-10-100-34-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link17-OriginFNAL-ip-192-168-17-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.17.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link48-TulsaRouter-ip-10-100-48-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.48.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link86-UChicagoRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link86-UChicagoRouter-ip-10-100-86-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#CacheBNL">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link6-CacheBNL"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#HartfordRouter"/>
    <topology:hasGUID>086eab16-57d8-431d-a874-de91d2b91898</topology:hasGUID>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash
  
#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )
echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#set ( $link = $linkset[0] )
echo $link &gt; /root/tmp
#set ( $gw = $HartfordRouter.IP($link) )
echo $gw &gt; /root/tmp

while ! ping -c 1 -n -w 1 $gw &amp;&gt; /dev/null
do
    echo "ping gw...." &gt;&gt; /root/tmp
    sleep 2
done
echo "\n%s\n"  "Server is back online" &gt;&gt; /root/tmp

ip route add 10.100.0.0/16 via $gw dev ens6
ip route add 172.16.0.0/16 via $gw dev ens6
ip route add 192.168.0.0/16 via $gw dev ens6

#set ( $hostname = $self.Name() )
echo $hostname:$gw &gt; /root/tmp_gw
#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp

</request-schema:postBootScript>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/unfvmsite.rdf#unfvmsite/Domain"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOMedium"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#LouisvilleRouter">
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#JacksonRouter"/>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/uhvmsite.rdf#uhvmsite/Domain"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <topology:hasGUID>1f8f869b-97c8-4553-a182-8fcdc3464123</topology:hasGUID>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link56-LouisvilleRouter"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 4
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 2
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp

</request-schema:postBootScript>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link55-LouisvilleRouter"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link5-MinneapolisRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link5-MinneapolisRouter-ip-10-100-5-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link11-OriginSeattle">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link11-OriginSeattle-ip-192-168-11-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link34-SaltLakeRouter-ip-10-100-34-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.34.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link82">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link82-HartfordRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link82-NewYorkRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>5dc4abfd-2d36-4459-830b-954ff2e3fb1d</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link79-PhillyRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link79-PhillyRouter-ip-10-100-79-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link87-PittRouter-ip-10-100-87-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.87.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link15-TucsonRouter-ip-192-168-15-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.15.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link20-SDRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link20-SDRouter-ip-192-168-20-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#UChicagoRouter">
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/uhvmsite.rdf#uhvmsite/Domain"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link64-UChicagoRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link61-UChicagoRouter"/>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 4
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 2
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp</request-schema:postBootScript>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link86-UChicagoRouter"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link14-UChicagoRouter"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link62-UChicagoRouter"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#MinneapolisRouter"/>
    <topology:hasGUID>48e3f333-0242-4e4c-a604-7067eeecaf79</topology:hasGUID>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link50-DallasRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link50-DallasRouter-ip-10-100-50-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link76-RaleighRouter-ip-10-100-76-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.76.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link47-MissoulaRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link47-MissoulaRouter-ip-10-100-47-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#TucsonRouter">
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link15-TucsonRouter"/>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/wsuvmsite.rdf#wsuvmsite/Domain"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link13-TucsonRouter"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <topology:hasGUID>64112d4f-1ded-4ad7-94f8-5a60ee191d5f</topology:hasGUID>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 4
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 2
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp
</request-schema:postBootScript>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link40-TucsonRouter"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link78-PhillyRouter-ip-10-100-78-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.78.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link58-ChicEQCHRouter-ip-10-100-58-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.58.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link7-DenverRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link7-DenverRouter-ip-10-100-7-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link37-SunnyvaleRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link37-SunnyvaleRouter-ip-10-100-37-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link23-LARouter-ip-192-168-23-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.23.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link31-LARouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link31-LARouter-ip-10-100-31-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link61">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link61-UChicagoRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link61-ChicEQCHRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>07a7fc17-2d5f-4ee7-8d0c-e4a581d4c5c1</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link36-SaltLakeRouter-ip-10-100-36-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.36.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link84-BostonRouter-ip-10-100-84-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.84.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link0-MissoulaRouter-ip-10-100-0-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.0.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link18-CacheUNL-ip-192-168-18-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.18.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link34-LasVegasRouter-ip-10-100-34-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.34.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link85">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link85-Cleveland"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link85-AlbanyRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>2b8affe3-8115-4599-9f6b-b8c9440e379d</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link16-FNALRouter-ip-192-168-16-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.16.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#DallasRouter">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link50-DallasRouter"/>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/uhvmsite.rdf#uhvmsite/Domain"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link49-DallasRouter"/>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 4
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 2
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp</request-schema:postBootScript>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <topology:hasGUID>b01f9e89-a810-43d2-86c8-c2fc7b6ae1b0</topology:hasGUID>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#HoustonRouter"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#PittRouter">
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#AshburnRouter"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/unfvmsite.rdf#unfvmsite/Domain"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link87-PittRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link88-PittRouter"/>
    <topology:hasGUID>a0befd31-3c74-469b-a30d-4466f5ba9c2f</topology:hasGUID>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 8
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 8
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp</request-schema:postBootScript>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link29-EugeneRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link29-EugeneRouter-ip-10-100-29-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link8-SeattleRouter-ip-10-100-8-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.8.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link4-NewYorkRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link4-NewYorkRouter-ip-192-168-4-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#AtlantaRouter">
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#JacksonvilleRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link71-AtlantaRouter"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash
  
#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )
echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#set ( $link = $linkset[0] )
echo $link &gt; /root/tmp
#set ( $gw = $CacheUNLRouter.IP($link) )
echo $gw &gt; /root/tmp

while ! ping -c 1 -n -w 1 $gw &amp;&gt; /dev/null
do
    echo "ping gw...." &gt;&gt; /root/tmp
    sleep 2
done
echo "\n%s\n"  "Server is back online" &gt;&gt; /root/tmp

ip route add 10.100.0.0/16 via $gw dev ens6
ip route add 172.16.0.0/16 via $gw dev ens6
ip route add 192.168.0.0/16 via $gw dev ens6

#set ( $hostname = $self.Name() )
echo $hostname:$gw &gt; /root/tmp_gw
#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp

</request-schema:postBootScript>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link75-AtlantaRouter"/>
    <topology:hasGUID>e80d33b4-612a-48c3-ab46-4975dc069e10</topology:hasGUID>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/uhvmsite.rdf#uhvmsite/Domain"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link68-AtlantaRouter"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link24-SeattleRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link24-SeattleRouter-ip-192-168-24-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link31-SunnyvaleRouter-ip-10-100-31-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.31.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link27-ELPasoRouter-ip-10-100-27-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.27.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link84">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link84-AlbanyRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link84-BostonRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>9ff1dcd1-edb0-4d07-8b9b-7d14fcc9344d</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link76-RaleighRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link76-RaleighRouter-ip-10-100-76-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link71-JacksonRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link71-JacksonRouter-ip-10-100-71-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#KansasCityRouter">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link19-KansasCityRouter"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 4
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 2
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp</request-schema:postBootScript>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link12-KansasCityRouter"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link5-KansasCityRouter"/>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/uhvmsite.rdf#uhvmsite/Domain"/>
    <topology:hasGUID>f458477e-42a1-43fe-a84b-5b7e084b85a8</topology:hasGUID>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link48-KansasCityRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link1-KansasCityRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link18-KansasCityRouter"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#JacksonRouter">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link51-JacksonRouter"/>
    <topology:hasGUID>5f9ce95f-afbc-4a3b-8190-caf8278349b9</topology:hasGUID>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link55-JacksonRouter"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#HoustonRouter"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/uhvmsite.rdf#uhvmsite/Domain"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link71-JacksonRouter"/>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 4
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 2
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp



</request-schema:postBootScript>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link86-Cleveland">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link86-Cleveland-ip-10-100-86-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link32-Storage0">
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link37-RenoRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link37-RenoRouter-ip-10-100-37-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link23-CacheCal">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link23-CacheCal-ip-192-168-23-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link63">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link63-FNALRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link63-ChicEQCHRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>3fb17acd-f3d8-4026-abf7-c6199ed3d650</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link51">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link51-JacksonRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link51-HoustonRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>dceff131-cc8e-4e74-948e-92e93596d822</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link87">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link87-PittRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link87-Cleveland"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>61f5b861-96fb-4236-b83a-18481a3a4f1c</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link2-DenverRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link2-DenverRouter-ip-10-100-2-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link75">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link75-CharlotteRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link75-AtlantaRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>9529c7e5-1ee2-420d-a5b4-bce1ec9e8c09</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link10-SeattleRouter-ip-10-100-10-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.10.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link71-AtlantaRouter-ip-10-100-71-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.71.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link54-PensacolaRouter-ip-10-100-54-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.54.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link5-KansasCityRouter-ip-10-100-5-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.5.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link5-KansasCityRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link5-KansasCityRouter-ip-10-100-5-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link24-CacheSeattle-ip-192-168-24-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.24.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link50">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link50-HoustonRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link50-DallasRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>3eea22f0-3686-45eb-aff1-66b7bc6cf459</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link63-FNALRouter-ip-10-100-63-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.63.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link6-CacheBNL-ip-192-168-6-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.6.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link85-Cleveland-ip-10-100-85-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.85.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link14-UChicagoRouter-ip-192-168-14-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.14.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link51-HoustonRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link51-HoustonRouter-ip-10-100-51-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link62">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link62-FNALRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link62-UChicagoRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>d0d7b260-4d20-4174-8fa0-4c7cc2439b34</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link56-LouisvilleRouter-ip-10-100-56-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.56.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link86">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link86-Cleveland"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link86-UChicagoRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>be118d8f-c7e9-415b-b4de-d87002cef268</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link56-LouisvilleRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link56-LouisvilleRouter-ip-10-100-56-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link88-PittRouter-ip-10-100-88-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.88.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link4-CacheNYU-ip-192-168-4-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.4.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link22-OriginCal">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link22-OriginCal-ip-192-168-22-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link71-JacksonRouter-ip-10-100-71-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.71.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#TermDuration">
    <time:days rdf:datatype="http://www.w3.org/2001/XMLSchema#decimal">14</time:days>
    <rdf:type rdf:resource="http://www.w3.org/2006/time#DurationDescription"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link89">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link89-WashingtonRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link89-AshburnRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>7779bb71-2048-444e-b3d9-948a2f343fa2</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link29-PortlandRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link29-PortlandRouter-ip-10-100-29-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link77">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link77-WashingtonRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link77-RaleighRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>78bd8606-9804-4786-8774-7c364c31674b</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link86-UChicagoRouter-ip-10-100-86-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.86.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link24-SeattleRouter-ip-192-168-24-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.24.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link20-SDRouter-ip-192-168-20-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.20.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link19-OriginUNL-ip-192-168-19-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.19.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#OriginCal">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link22-OriginCal"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#LARouter"/>
    <topology:hasGUID>d62abb52-6bf4-4dc3-ba2d-cb108dbd8a60</topology:hasGUID>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash
  
#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )
echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#set ( $link = $linkset[0] )
echo $link &gt; /root/tmp
#set ( $gw = $LARouter.IP($link) )
echo $gw &gt; /root/tmp

while ! ping -c 1 -n -w 1 $gw &amp;&gt; /dev/null
do
    echo "ping gw...." &gt;&gt; /root/tmp
    sleep 2
done
echo "\n%s\n"  "Server is back online" &gt;&gt; /root/tmp

ip route add 10.100.0.0/16 via $gw dev ens6
ip route add 172.16.0.0/16 via $gw dev ens6
ip route add 192.168.0.0/16 via $gw dev ens6

#set ( $hostname = $self.Name() )
echo $hostname:$gw &gt; /root/tmp_gw
#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp

</request-schema:postBootScript>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/wsuvmsite.rdf#wsuvmsite/Domain"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOMedium"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link22-OriginCal-ip-192-168-22-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.22.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#BatonRougeRouter">
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link28-BatonRougeRouter"/>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/uhvmsite.rdf#uhvmsite/Domain"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link52-BatonRougeRouter"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#HoustonRouter"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 8
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 8
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp</request-schema:postBootScript>
    <topology:hasGUID>8a96874d-21ec-4f2c-b375-9e3f4ca72977</topology:hasGUID>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/unfvmsite.rdf#unfvmsite/Domain">
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkDomain"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#TulsaRouter">
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#DallasRouter"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <topology:hasGUID>95e371c8-1b03-4a18-9994-dc5dc46c1e6d</topology:hasGUID>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link49-TulsaRouter"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/uhvmsite.rdf#uhvmsite/Domain"/>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 4
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 2
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp</request-schema:postBootScript>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link48-TulsaRouter"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link88">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link88-AshburnRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link88-PittRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>4ef26e8c-775b-45ea-85d7-45f492a338e7</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link83-BostonRouter-ip-10-100-83-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.83.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link52">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link52-PensacolaRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link52-BatonRougeRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>fcbd19b5-1e96-406c-b275-b2a603379602</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link40">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link40-TucsonRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link40-SDRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>8f40939c-d48d-43fc-9315-b1a4067855cc</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link76">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link76-RaleighRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link76-CharlotteRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>277538ca-1b5a-403e-8139-09d9f3e37a87</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#MissoulaRouter">
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link47-MissoulaRouter"/>
    <topology:hasGUID>0231dc5c-488b-462c-8a88-16778c7511b2</topology:hasGUID>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 4
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 2
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp</request-schema:postBootScript>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/wsuvmsite.rdf#wsuvmsite/Domain"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link0-MissoulaRouter"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#SeattleRouter"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link64">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link64-UChicagoRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link64-MinneapolisRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>44560338-492c-4797-b467-1bf4129c368f</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link58-ChicEQCHRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link58-ChicEQCHRouter-ip-10-100-58-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link84-AlbanyRouter-ip-10-100-84-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.84.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link77-RaleighRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link77-RaleighRouter-ip-10-100-77-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link7-SaltLakeRouter-ip-10-100-7-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.7.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link57-CincinnatiRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link57-CincinnatiRouter-ip-10-100-57-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#RaleighRouter">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link77-RaleighRouter"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 8
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 8
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp
</request-schema:postBootScript>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#CharlotteRouter"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link76-RaleighRouter"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <topology:hasGUID>4cc28a86-5b1a-4f13-9236-ceb1a34f584c</topology:hasGUID>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/unfvmsite.rdf#unfvmsite/Domain"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link68-AtlantaRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link68-AtlantaRouter-ip-10-100-68-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#SunnyvaleRouter">
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link30-SunnyvaleRouter"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link31-SunnyvaleRouter"/>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 4
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 2
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp

</request-schema:postBootScript>
    <topology:hasGUID>948c8a82-78e6-4108-986c-79a141f0def1</topology:hasGUID>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link37-SunnyvaleRouter"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/wsuvmsite.rdf#wsuvmsite/Domain"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link21-SDRouter-ip-192-168-21-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.21.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link33-LARouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link33-LARouter-ip-10-100-33-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link55">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link55-LouisvilleRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link55-JacksonRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>2250e176-55b9-46d9-8f67-b6196d7ac0e8</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link79">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link79-NYCRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link79-PhillyRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>7c3829de-2b7e-4e3e-9f9c-ce6ffdd4d076</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link61-ChicEQCHRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link61-ChicEQCHRouter-ip-10-100-61-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link47-MinneapolisRouter-ip-10-100-47-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.47.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link31">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link31-LARouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link31-SunnyvaleRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>567b9dc5-4010-4e2a-a888-35bbeb104620</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link33-LasVegasRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link33-LasVegasRouter-ip-10-100-33-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link14-CacheUChic">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link14-CacheUChic-ip-192-168-14-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link15-OriginNCSA-ip-192-168-15-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.15.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link30-SunnyvaleRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link30-SunnyvaleRouter-ip-10-100-30-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link24-CacheSeattle">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link24-CacheSeattle-ip-192-168-24-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link10-SaltLakeRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link10-SaltLakeRouter-ip-10-100-10-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#CharlotteRouter">
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 8
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 8
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp
</request-schema:postBootScript>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#AtlantaRouter"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link76-CharlotteRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link75-CharlotteRouter"/>
    <topology:hasGUID>2c9502ac-34ae-4b29-828f-3451d0b74e97</topology:hasGUID>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/uhvmsite.rdf#uhvmsite/Domain"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link50-HoustonRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link50-HoustonRouter-ip-10-100-50-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link12-KansasCityRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link12-KansasCityRouter-ip-10-100-12-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link78">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link78-PhillyRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link78-WashingtonRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>aafaa47c-504f-44a6-9b6a-ac46815a47b9</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link30">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link30-SunnyvaleRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link30-EugeneRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>21b6f99a-3607-4568-b225-f61e76a04f3b</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link54">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link54-JacksonvilleRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link54-PensacolaRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>39a2d8bb-1484-4a9c-b0e3-e24bac357456</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#FNALRouter">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link16-FNALRouter"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link63-FNALRouter"/>
    <topology:hasGUID>46ffc5f2-80d4-4be9-b2fb-5131ee12cda9</topology:hasGUID>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link62-FNALRouter"/>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/uhvmsite.rdf#uhvmsite/Domain"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 4
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 2
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp</request-schema:postBootScript>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link17-FNALRouter"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#UChicagoRouter"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#CincinnatiRouter">
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#LouisvilleRouter"/>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/uhvmsite.rdf#uhvmsite/Domain"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link56-CincinnatiRouter"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link57-CincinnatiRouter"/>
    <topology:hasGUID>3fb806a3-c135-4f1b-9ab6-5f4733c5a932</topology:hasGUID>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 4
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 2
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp</request-schema:postBootScript>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link89-WashingtonRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link89-WashingtonRouter-ip-10-100-89-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link89-AshburnRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link89-AshburnRouter-ip-10-100-89-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link62-FNALRouter-ip-10-100-62-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.62.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link71-AtlantaRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link71-AtlantaRouter-ip-10-100-71-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Control">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link32-Control"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Storage0"/>
    <topology:hasGUID>4a481e30-95e1-488a-ac36-2eca4f6c65a3</topology:hasGUID>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

cd /root
git clone https://github.com/RENCI-NRIG/IRIS.git
git clone -b storage https://github.com/RENCI-NRIG/chaos-jungle.git</request-schema:postBootScript>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/uhvmsite.rdf#uhvmsite/Domain"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOMedium"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link33">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link33-LasVegasRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link33-LARouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>d1e08365-2d21-4b40-8cf1-fcbdfd586bb4</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#WashingtonRouter">
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/unfvmsite.rdf#unfvmsite/Domain"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link78-WashingtonRouter"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link89-WashingtonRouter"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#RaleighRouter"/>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 8
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 8
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp
</request-schema:postBootScript>
    <topology:hasGUID>12c32bc6-c260-4089-b8ba-05b82dcda6e8</topology:hasGUID>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link77-WashingtonRouter"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link57">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link57-IndianapolisRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link57-CincinnatiRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>b4752907-e2d4-4a92-8e0a-601b1362fa55</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link75-CharlotteRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link75-CharlotteRouter-ip-10-100-75-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link21">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link21-SDRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link21-CacheUC"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>5944df63-1979-4df6-8ef8-2d4c1a30cb74</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link17-FNALRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link17-FNALRouter-ip-192-168-17-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link38-LARouter-ip-10-100-38-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.38.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link7">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link7-DenverRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link7-SaltLakeRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>370fd319-bc91-405e-8ff0-a01bc965e055</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link15-TucsonRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link15-TucsonRouter-ip-192-168-15-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#OriginUNL">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link19-OriginUNL"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#KansasCityRouter"/>
    <topology:hasGUID>9ae9e32e-45b5-4d45-bbed-8319028fb63a</topology:hasGUID>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash
  
#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )
echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#set ( $link = $linkset[0] )
echo $link &gt; /root/tmp
#set ( $gw = $KansasCityRouter.IP($link) )
echo $gw &gt; /root/tmp

while ! ping -c 1 -n -w 1 $gw &amp;&gt; /dev/null
do
    echo "ping gw...." &gt;&gt; /root/tmp
    sleep 2
done
echo "\n%s\n"  "Server is back online" &gt;&gt; /root/tmp

ip route add 10.100.0.0/16 via $gw dev ens6
ip route add 172.16.0.0/16 via $gw dev ens6
ip route add 192.168.0.0/16 via $gw dev ens6

#set ( $hostname = $self.Name() )
echo $hostname:$gw &gt; /root/tmp_gw
#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp

</request-schema:postBootScript>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/uhvmsite.rdf#uhvmsite/Domain"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOMedium"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link62-UChicagoRouter-ip-10-100-62-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.62.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link56">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link56-CincinnatiRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link56-LouisvilleRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>9b73b142-15e5-4e63-a558-815d12c0d7fe</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#JacksonvilleRouter">
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link68-JacksonvilleRouter"/>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 8
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 8
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp
</request-schema:postBootScript>
    <topology:hasGUID>77419e49-8e5e-42a2-b388-1ac9430bfb6a</topology:hasGUID>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link54-JacksonvilleRouter"/>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/unfvmsite.rdf#unfvmsite/Domain"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#PensacolaRouter"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link68">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link68-AtlantaRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link68-JacksonvilleRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>bb699b25-6376-44ec-b268-2c906d307c00</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#NewYorkRouter">
    <topology:hasGUID>ce3c2268-3e94-4d34-8925-4146b21274ff</topology:hasGUID>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 8
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 8
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp
</request-schema:postBootScript>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link80-NewYorkRouter"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link82-NewYorkRouter"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link81-NewYorkRouter"/>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/unfvmsite.rdf#unfvmsite/Domain"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link4-NewYorkRouter"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#NYCRouter"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link32">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link32-Control"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link32-Storage0"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>2bc3757a-d57a-4c03-b861-1e3d537cbd12</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link33-LARouter-ip-10-100-33-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.33.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link38-SDRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link38-SDRouter-ip-10-100-38-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link77-WashingtonRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link77-WashingtonRouter-ip-10-100-77-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link20">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link20-SDRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link20-OriginSDSC"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>c588e500-a029-4678-a899-b453e1f0d164</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link52-PensacolaRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link52-PensacolaRouter-ip-10-100-52-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link40-SDRouter-ip-10-100-40-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.40.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link6">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link6-CacheBNL"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link6-HartfordRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>87e179aa-b0c4-4738-a26c-8069e9b1d20c</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link82-NewYorkRouter-ip-10-100-82-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.82.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link36-SaltLakeRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link36-SaltLakeRouter-ip-10-100-36-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link3-AlbanyRouter-ip-192-168-3-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.3.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link23">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link23-CacheCal"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link23-LARouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>15f74c0d-502d-4955-9541-9b757f3e121a</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link47-MinneapolisRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link47-MinneapolisRouter-ip-10-100-47-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link11">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link11-OriginSeattle"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link11-SeattleRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>ff2e1d07-96e1-43a7-8363-3029a0ad7fc9</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link47">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link47-MinneapolisRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link47-MissoulaRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>be83ebaa-f81a-411e-8b04-96565f387e0c</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link87-Cleveland">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link87-Cleveland-ip-10-100-87-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link18-CacheUNL">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link18-CacheUNL-ip-192-168-18-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link56-CincinnatiRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link56-CincinnatiRouter-ip-10-100-56-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link16-CacheFNAL">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link16-CacheFNAL-ip-192-168-16-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#HartfordRouter">
    <topology:hasGUID>228169f0-87fe-47f3-88cb-9375422206df</topology:hasGUID>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link82-HartfordRouter"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#NewYorkRouter"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link6-HartfordRouter"/>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 8
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 8
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp</request-schema:postBootScript>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link83-HartfordRouter"/>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/unfvmsite.rdf#unfvmsite/Domain"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link48-KansasCityRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link48-KansasCityRouter-ip-10-100-48-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link82-HartfordRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link82-HartfordRouter-ip-10-100-82-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link18-KansasCityRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link18-KansasCityRouter-ip-192-168-18-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link34">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link34-SaltLakeRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link34-LasVegasRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>d5c25a6c-6b42-4131-8457-1ee28342bbd2</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link22">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link22-LARouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link22-OriginCal"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>c81b28a0-dbef-41b7-92e5-5b4fb4cdd928</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link58">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link58-ChicEQCHRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link58-IndianapolisRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>482d5e75-7a28-4aa2-8e7c-09d7af1f07e6</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link88-AshburnRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link88-AshburnRouter-ip-10-100-88-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link13-ELPasoRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link13-ELPasoRouter-ip-10-100-13-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link57-CincinnatiRouter-ip-10-100-57-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.57.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link10">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link10-SeattleRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link10-SaltLakeRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>3c1a7330-a5cb-4024-b69d-18a091803ec8</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link68-AtlantaRouter-ip-10-100-68-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.68.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link79-NYCRouter-ip-10-100-79-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.79.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#PhillyRouter">
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <topology:hasGUID>179e6cee-baad-4123-902a-324ab0f573fe</topology:hasGUID>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 8
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 8
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp
</request-schema:postBootScript>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link79-PhillyRouter"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#WashingtonRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link78-PhillyRouter"/>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/unfvmsite.rdf#unfvmsite/Domain"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link49-TulsaRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link49-TulsaRouter-ip-10-100-49-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#LARouter">
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 4
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 2
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp


</request-schema:postBootScript>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link33-LARouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link23-LARouter"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#SunnyvaleRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link31-LARouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link38-LARouter"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <topology:hasGUID>91f8b495-4dc9-4fae-93c6-8fa50abbbcda</topology:hasGUID>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/wsuvmsite.rdf#wsuvmsite/Domain"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link22-LARouter"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link75-CharlotteRouter-ip-10-100-75-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.75.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link8">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link8-PortlandRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link8-SeattleRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>766ccb13-a3b0-46b6-827f-fc58541b4927</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link8-PortlandRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link8-PortlandRouter-ip-10-100-8-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link81-NYCRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link81-NYCRouter-ip-10-100-81-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link1-KansasCityRouter-ip-10-100-1-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.1.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link52-BatonRougeRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link52-BatonRougeRouter-ip-10-100-52-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link17-FNALRouter-ip-192-168-17-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.17.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#">
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link87"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link27"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link63"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#OriginUNL"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link68"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link58"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#PhillyRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#CacheFNAL"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#AshburnRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#JacksonvilleRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link82"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link81"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link24"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link14"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link76"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link77"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#UChicagoRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#DenverRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link16"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link17"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link7"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link32"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link8"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link33"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link52"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#ELPasoRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#SunnyvaleRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#PortlandRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#CacheBNL"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link2"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#LouisvilleRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link47"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/request.owl#Reservation"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#CacheSyracuse"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#NewYorkRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link49"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link23"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#LARouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#CacheNYU"/>
    <request-schema:hasTerm rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Term"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link85"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link86"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link62"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link61"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#TucsonRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#OriginFNAL"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link36"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link56"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link57"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link12"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link80"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link13"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link71"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#OriginSDSC"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link1"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#IndianapolisRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link6"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#AtlantaRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Cleveland"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link89"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link29"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#WashingtonRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#OriginSeattle"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#NYCRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#DallasRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#CincinnatiRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link22"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link48"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link21"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link38"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#RenoRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link84"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#CacheUChic"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link75"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link15"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link5"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link40"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link30"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link31"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link50"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link51"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#BatonRougeRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#PensacolaRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#BostonRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#KansasCityRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link0"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#CharlotteRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#PittRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#CacheUC"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#HartfordRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#MinneapolisRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#MissoulaRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#OriginCal"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#OriginNCSA"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link83"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#CacheUNL"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link28"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link78"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link88"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#SDRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#LasVegasRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link79"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Control"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link18"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link19"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link64"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link34"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#ChicEQCHRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#SeattleRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link54"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link55"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link20"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#CacheCal"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link10"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link37"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#FNALRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link11"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link3"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link4"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#TulsaRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#RaleighRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Storage0"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#AlbanyRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#EugeneRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#JacksonRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#SaltLakeRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#HoustonRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#CacheSeattle"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link13">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link13-TucsonRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link13-ELPasoRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>e1fecf7f-f612-4e32-96d8-33936aa4b385</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link4-NewYorkRouter-ip-192-168-4-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.4.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link88-AshburnRouter-ip-10-100-88-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.88.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link3-CacheSyracuse">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link3-CacheSyracuse-ip-192-168-3-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link49">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link49-DallasRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link49-TulsaRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>5540f145-27fe-4503-aa58-048ef2b28883</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link48-KansasCityRouter-ip-10-100-48-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.48.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link3">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link3-AlbanyRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link3-CacheSyracuse"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>83a5dd67-9b42-4e8f-84ff-132730675cfe</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link37">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link37-RenoRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link37-SunnyvaleRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>41ef1031-9c38-44f4-b0c5-87c06d84fc81</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link63-ChicEQCHRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link63-ChicEQCHRouter-ip-10-100-63-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link86-Cleveland-ip-10-100-86-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.86.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link57-IndianapolisRouter-ip-10-100-57-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.57.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link64-UChicagoRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link64-UChicagoRouter-ip-10-100-64-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link12">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link12-ChicEQCHRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link12-KansasCityRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>9eb13431-d4cf-46a3-8790-704b37c241ae</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link36">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link36-SaltLakeRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link36-RenoRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>9e3fb838-07b1-4157-bb2e-b053f2f342fe</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link24">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link24-CacheSeattle"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link24-SeattleRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>09e7bb6e-bfb7-4f6f-8b7b-c5268a756493</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link81-NewYorkRouter-ip-10-100-81-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.81.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link85-Cleveland">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link85-Cleveland-ip-10-100-85-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link3-AlbanyRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link3-AlbanyRouter-ip-192-168-3-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link2">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link2-DenverRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link2-ELPasoRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>e7404f1b-d273-4148-a896-ce7eb77bcc88</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link48">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link48-TulsaRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link48-KansasCityRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>fbab6c15-4191-4f99-822c-4565364257c0</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link47-MissoulaRouter-ip-10-100-47-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.47.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link68-JacksonvilleRouter-ip-10-100-68-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.68.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link8-SeattleRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link8-SeattleRouter-ip-10-100-8-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link56-CincinnatiRouter-ip-10-100-56-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.56.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link75-AtlantaRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link75-AtlantaRouter-ip-10-100-75-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link13-TucsonRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link13-TucsonRouter-ip-10-100-13-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link27">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link27-HoustonRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link27-ELPasoRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>8ef46008-e52b-4005-9727-f501c31c9e6c</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link15">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link15-OriginNCSA"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link15-TucsonRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>ca6062f7-dd86-4d54-9c12-0c7908bdb7e6</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link22-LARouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link22-LARouter-ip-192-168-22-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link5">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link5-MinneapolisRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link5-KansasCityRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>252484e8-a930-4f4d-ad6b-89b0258f1b27</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link61-UChicagoRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link61-UChicagoRouter-ip-10-100-61-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link6-CacheBNL">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link6-CacheBNL-ip-192-168-6-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link2-ELPasoRouter-ip-10-100-2-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.2.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link14">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link14-CacheUChic"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link14-UChicagoRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>54b9b36f-e57f-464d-a332-e3484a261d38</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link48-TulsaRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link48-TulsaRouter-ip-10-100-48-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#NYCRouter">
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#PhillyRouter"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <topology:hasGUID>25965427-5d26-44ee-aa26-26a1ae423d09</topology:hasGUID>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link80-NYCRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link79-NYCRouter"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 8
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 8
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp
</request-schema:postBootScript>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/unfvmsite.rdf#unfvmsite/Domain"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link81-NYCRouter"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#PensacolaRouter">
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 8
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 8
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp
</request-schema:postBootScript>
    <topology:hasGUID>065d8aa0-7beb-49de-acbb-9bf07ec58b9e</topology:hasGUID>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link54-PensacolaRouter"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#BatonRougeRouter"/>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/unfvmsite.rdf#unfvmsite/Domain"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link52-PensacolaRouter"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#MinneapolisRouter">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link64-MinneapolisRouter"/>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/uhvmsite.rdf#uhvmsite/Domain"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#MissoulaRouter"/>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 4
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 2
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp</request-schema:postBootScript>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link47-MinneapolisRouter"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link5-MinneapolisRouter"/>
    <topology:hasGUID>380c1584-83a1-4579-9455-ce467055a63a</topology:hasGUID>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link28-BatonRougeRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link28-BatonRougeRouter-ip-10-100-28-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link37-SunnyvaleRouter-ip-10-100-37-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.37.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link38">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link38-SDRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link38-LARouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>80fa9f6e-7ca9-4d14-9cc9-8878f04edcab</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link4">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link4-CacheNYU"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link4-NewYorkRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>194854ea-6104-4f04-86ba-745c120d149f</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link81-NewYorkRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link81-NewYorkRouter-ip-10-100-81-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link79-NYCRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link79-NYCRouter-ip-10-100-79-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#PortlandRouter">
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#SeattleRouter"/>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 4
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 2
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp</request-schema:postBootScript>
    <topology:hasGUID>43d95ed3-9718-4e1f-ba29-2ab81877b51e</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link29-PortlandRouter"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/wsuvmsite.rdf#wsuvmsite/Domain"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link8-PortlandRouter"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link55-LouisvilleRouter-ip-10-100-55-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.55.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link38-LARouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link38-LARouter-ip-10-100-38-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link7-DenverRouter-ip-10-100-7-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.7.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link83-BostonRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link83-BostonRouter-ip-10-100-83-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link84-AlbanyRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link84-AlbanyRouter-ip-10-100-84-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link19-KansasCityRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link19-KansasCityRouter-ip-192-168-19-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link32-Control">
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link1-KansasCityRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link1-KansasCityRouter-ip-10-100-1-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/wsuvmsite.rdf#wsuvmsite/Domain">
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkDomain"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link61-UChicagoRouter-ip-10-100-61-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.61.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link29-PortlandRouter-ip-10-100-29-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.29.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link29">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link29-EugeneRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link29-PortlandRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>c76edfd0-6586-4ce6-a30b-8090d171cc75</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link17">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link17-OriginFNAL"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link17-FNALRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>373e90ef-5eba-43a7-ab8c-9805991471b2</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link54-PensacolaRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link54-PensacolaRouter-ip-10-100-54-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link64-MinneapolisRouter-ip-10-100-64-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.64.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link40-TucsonRouter-ip-10-100-40-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.40.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link15-OriginNCSA">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link15-OriginNCSA-ip-192-168-15-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link85-AlbanyRouter-ip-10-100-85-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.85.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Storage0">
    <j.0:hasMntPoint rdf:datatype="http://www.w3.org/2001/XMLSchema#string">/mnt/target</j.0:hasMntPoint>
    <j.0:doFormat rdf:datatype="http://www.w3.org/2001/XMLSchema#boolean">true</j.0:doFormat>
    <topology:hasGUID>62022a09-5d33-4084-8258-46a22b257254</topology:hasGUID>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/uhvmsite.rdf#uhvmsite/Domain"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/storage.owl#ISCSI"/>
    <j.0:hasFSParam rdf:datatype="http://www.w3.org/2001/XMLSchema#string">-F -b 2048</j.0:hasFSParam>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link32-Storage0"/>
    <j.0:storageCapacity rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">3000</j.0:storageCapacity>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/storage.owl#LUN"/>
    <j.0:hasFSType rdf:datatype="http://www.w3.org/2001/XMLSchema#string">ext4</j.0:hasFSType>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2">
    <topology:hasName rdf:datatype="http://www.w3.org/2001/XMLSchema#string">Ubuntu 18.04 QCOW2 v1.0.2</topology:hasName>
    <topology:hasURL>http://geni-images.renci.org/images/standard/ubuntu-comet/ubuntu-18.04/ubuntu-18.04.xml</topology:hasURL>
    <topology:hasGUID>fe66b08bffa14c385ad64edd124350a2da826af9</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#DiskImage"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link16-FNALRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link16-FNALRouter-ip-192-168-16-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#RenoRouter">
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 4
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 2
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp</request-schema:postBootScript>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/wsuvmsite.rdf#wsuvmsite/Domain"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link37-RenoRouter"/>
    <topology:hasGUID>1fd576af-c682-4a18-88ee-ec67be2fcac2</topology:hasGUID>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link36-RenoRouter"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#SunnyvaleRouter"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link16">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link16-CacheFNAL"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link16-FNALRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>64b25075-5660-4d88-9983-e2b4c2dd312c</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#CacheUChic">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link14-CacheUChic"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#UChicagoRouter"/>
    <topology:hasGUID>30422893-7183-40c5-8704-f6956f0179c6</topology:hasGUID>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash
  
#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )
echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#set ( $link = $linkset[0] )
echo $link &gt; /root/tmp
#set ( $gw = $UChicagoRouter.IP($link) )
echo $gw &gt; /root/tmp

while ! ping -c 1 -n -w 1 $gw &amp;&gt; /dev/null
do
    echo "ping gw...." &gt;&gt; /root/tmp
    sleep 2
done
echo "\n%s\n"  "Server is back online" &gt;&gt; /root/tmp

ip route add 10.100.0.0/16 via $gw dev ens6
ip route add 172.16.0.0/16 via $gw dev ens6
ip route add 192.168.0.0/16 via $gw dev ens6

#set ( $hostname = $self.Name() )
echo $hostname:$gw &gt; /root/tmp_gw
#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp</request-schema:postBootScript>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/uhvmsite.rdf#uhvmsite/Domain"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOMedium"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link28">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link28-BatonRougeRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link28-HoustonRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>c6aa9d08-f183-4831-bc32-510e470aa9c7</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link23-LARouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link23-LARouter-ip-192-168-23-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#CacheNYU">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link4-CacheNYU"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#NewYorkRouter"/>
    <topology:hasGUID>cc0bf3bf-c781-4b5b-aadd-c450b624b5d2</topology:hasGUID>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash
  
sleep 5
#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )
echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#set ( $link = $linkset[0] )
echo $link &gt; /root/tmp
#set ( $gw = $NewYorkRouter.IP($link) )
echo $gw &gt; /root/tmp

while ! ping -c 1 -n -w 1 $gw &amp;&gt; /dev/null
do
    echo "ping gw...." &gt;&gt; /root/tmp
    sleep 2
done
echo "\n%s\n"  "Server is back online" &gt;&gt; /root/tmp

ip route add 10.100.0.0/16 via $gw dev ens6
ip route add 172.16.0.0/16 via $gw dev ens6
ip route add 192.168.0.0/16 via $gw dev ens6

#set ( $hostname = $self.Name() )
echo $hostname:$gw &gt; /root/tmp_gw
#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp</request-schema:postBootScript>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/unfvmsite.rdf#unfvmsite/Domain"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOMedium"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link11-OriginSeattle-ip-192-168-11-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.11.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link49-TulsaRouter-ip-10-100-49-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.49.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#OriginNCSA">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link15-OriginNCSA"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#TucsonRouter"/>
    <topology:hasGUID>fdf338d2-14c1-4113-902d-0b46bb12d155</topology:hasGUID>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash
  
#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )
echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#set ( $link = $linkset[0] )
echo $link &gt; /root/tmp
#set ( $gw = $TucsonRouter.IP($link) )
echo $gw &gt; /root/tmp

while ! ping -c 1 -n -w 1 $gw &amp;&gt; /dev/null
do
    echo "ping gw...." &gt;&gt; /root/tmp
    sleep 2
done
echo "\n%s\n"  "Server is back online" &gt;&gt; /root/tmp

ip route add 10.100.0.0/16 via $gw dev ens6
ip route add 172.16.0.0/16 via $gw dev ens6
ip route add 192.168.0.0/16 via $gw dev ens6

#set ( $hostname = $self.Name() )
echo $hostname:$gw &gt; /root/tmp_gw
#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp

</request-schema:postBootScript>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/wsuvmsite.rdf#wsuvmsite/Domain"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOMedium"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link82-HartfordRouter-ip-10-100-82-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.82.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#SDRouter">
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <topology:hasGUID>ec1ee835-484e-4c2b-864e-df7d7d8814f8</topology:hasGUID>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link21-SDRouter"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#TucsonRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link40-SDRouter"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link38-SDRouter"/>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 4
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 2
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp</request-schema:postBootScript>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link20-SDRouter"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link22-LARouter-ip-192-168-22-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.22.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#DenverRouter">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link7-DenverRouter"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#SaltLakeRouter"/>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/uhvmsite.rdf#uhvmsite/Domain"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link1-DenverRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link2-DenverRouter"/>
    <topology:hasGUID>32eb38f5-294b-4599-8de2-69a485881f7c</topology:hasGUID>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 4
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 2
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp

</request-schema:postBootScript>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link19">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link19-OriginUNL"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link19-KansasCityRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>ecfbc6b6-3959-4566-a517-6510e044cc49</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link51-HoustonRouter-ip-10-100-51-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.51.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link1">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link1-DenverRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link1-KansasCityRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>a0010898-24ac-4142-8099-c10dead2c006</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link31-LARouter-ip-10-100-31-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.31.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link78-WashingtonRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link78-WashingtonRouter-ip-10-100-78-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#ChicEQCHRouter">
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 4
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 2
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp</request-schema:postBootScript>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link58-ChicEQCHRouter"/>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/uhvmsite.rdf#uhvmsite/Domain"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link12-ChicEQCHRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link61-ChicEQCHRouter"/>
    <topology:hasGUID>1c2295a6-6013-487f-b0d3-590697acb8b2</topology:hasGUID>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link63-ChicEQCHRouter"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#KansasCityRouter"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link0-SeattleRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link0-SeattleRouter-ip-10-100-0-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#IndianapolisRouter">
    <topology:hasGUID>f9eb6b98-33f6-48e1-a615-f69f131dc777</topology:hasGUID>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#ChicEQCHRouter"/>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/uhvmsite.rdf#uhvmsite/Domain"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link57-IndianapolisRouter"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link58-IndianapolisRouter"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 4
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 2
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp</request-schema:postBootScript>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link84-BostonRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link84-BostonRouter-ip-10-100-84-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link19-OriginUNL">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link19-OriginUNL-ip-192-168-19-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link82-NewYorkRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link82-NewYorkRouter-ip-10-100-82-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link7-SaltLakeRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link7-SaltLakeRouter-ip-10-100-7-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#EugeneRouter">
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <request-schema:inDomain rdf:resource="http://geni-orca.renci.org/owl/wsuvmsite.rdf#wsuvmsite/Domain"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#SunnyvaleRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link30-EugeneRouter"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link29-EugeneRouter"/>
    <topology:hasGUID>7489ddff-875f-4e6e-a661-6a63d8e12351</topology:hasGUID>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 4
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 2
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp</request-schema:postBootScript>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link80-NYCRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link80-NYCRouter-ip-10-100-80-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link89-WashingtonRouter-ip-10-100-89-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.89.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link85-AlbanyRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link85-AlbanyRouter-ip-10-100-85-1"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link75-AtlantaRouter-ip-10-100-75-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.75.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link0">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link0-MissoulaRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link0-SeattleRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>591be294-519c-4dad-bf36-ac5a09b80086</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link38-SDRouter-ip-10-100-38-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.38.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link18">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link18-CacheUNL"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link18-KansasCityRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>0cd5133b-b4e3-4ccb-8f44-1890f2329feb</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link28-HoustonRouter-ip-10-100-28-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.28.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/a49f84bc-52fe-4340-8d97-da0dc4feee6e#Link30-SunnyvaleRouter-ip-10-100-30-1">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.30.1</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
</rdf:RDF>
